# imtest
IM 测试工具包 v1.0 程序设计思路：
Conf：配置是活的，但又是相对静态的
    conf需要做的事：
        （1）配置发送消息条数
        （2）配置发送消息类型
        （3）配置发送消息的通用数据（fromUid, toGroupId, atUid, productId, cuid）
        （4）配置发送消息的方式（设计4种套餐场景）
            a、随机消息类型发送消息
            b、遍历指定的消息类型间隔发送消息
            c、指定某种消息类型进行发送
            d、变更时间频率对消息进行发送
        主要分为频率维度（1、定频发送 2、随机频率发送）；消息类型维度（1、单消息类型 2、随机消息类型 3、指定多消息类型遍历）；数量维度（配置消息总数）
        （5）配置个性化设计
            a、文本消息类型（1、超长文本 2、报数文本 3、黄反脏话集 4、特殊字符集）
            b、图片消息类型（1、超长图 2、超宽图 3、非图片格式）
            c、语音消息类型（待补充）

    所以，IM 测试工具包 v1.0 需要做的开关及配置有：
        1、发送消息总数
        2、配置发送消息的通用数据
        3、发送消息频率：定频发送 => 0 ，随机发送 => 1
        4、消息类型发送策略：单消息类型 => 0 ，随机消息类型 => 1 ，指定多消息类型遍历 =>2 （逻辑层要分别封装3个方法）
        5、消息类型发送开关（array）：文本、@、图片、语音、gif （不能发送该消息类型的消息 => 0，能发送该消息类型的消息 => 1）
        6、个性化配置


Logic:发送消息的业务逻辑处理：
    logic需要做的事：
        1、读conf
        2、读data（消息体body的封装）
        3、拼装arrayInput
        4、定制消息发送策略：根据读取的conf数据，封装一个循环结构（重点）
        5、调用发消息通用接口SendMsgBasic
        6、设计一个入口函数，供controller调用

    初步设想：
    1、需要一个入口函数execute供Controller调用，Controller必须做到傻瓜式执行，不传参数
    2、读conf方法已经封装好，不用重新定义；读data的方法也不需要重新去定义，直接调用即可
    3、将conf和data进行比对，进行业务逻辑处理，最后调用后端PHP代码的ps层的execute方法，去发送消息即可

    logicSend方法涉及思路：
    （1）Conf数据分组分类
    （2）按是否是@消息，分成两大类
        a、@消息分两层循环嵌套（假如conf里面是否发送@消息置1，进入@循环）
            传入@消息的总数和普通消息发送数
        b、非@消息一层循环嵌套（只发送常规消息）

Data：静态常量及数组的封装：
    Data需要做的事：
    1、data层封装一系列数组或变量，供logic层调用，相当于odp的dao
    2、IM 测试工具包 V1.1可以做得简单一些，分为3个文件
        （1）IMTest_Msg_Data  封装消息发送相关的数组及变量
        （2）IMTest_Group_Data  封装群组建设相关的数组及变量
        （3）IMTest_Query_Data  封装IM相关查询的字段等


Controller主要做的事：
    用户操作指南：
    1、首先设置conf
    2、执行以下操作
        php StartSend.php  执行自动发消息程序
        or ./Batch_Group_Sync.sh  多进程多群单同步并发消息
        or ./batch_Member_Sync.sh  多进程单群多用户并发消息

Log主要做的事：
    封装统一且适合该工具包的日志类

上述是IMTest V1.0.0
更新说明：SendMsg 1期开发完成，TestLog封装好了供整个项目使用的log类
消息发送运行方法：
Step1：修改配置文档：E:\project\PHP\IMTest\IMTest\SendMsg\Conf\Config.txt
Step2：启动中控程序：php IMTest_Run.php
下版需求：Group群组建设
------------------------------------------------------------------------------------------------------------------------
